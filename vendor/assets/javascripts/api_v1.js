// https://github.com/dankogai/js-base64
(function(global){"use strict";if(global.Base64)return;var version="2.1.2";var buffer;if(typeof module!=="undefined"&&module.exports){buffer=require("buffer").Buffer}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64tab=function(bin){var t={};for(var i=0,l=bin.length;i<l;i++)t[bin.charAt(i)]=i;return t}(b64chars);var fromCharCode=String.fromCharCode;var cb_utob=function(c){if(c.length<2){var cc=c.charCodeAt(0);return cc<128?c:cc<2048?fromCharCode(192|cc>>>6)+fromCharCode(128|cc&63):fromCharCode(224|cc>>>12&15)+fromCharCode(128|cc>>>6&63)+fromCharCode(128|cc&63)}else{var cc=65536+(c.charCodeAt(0)-55296)*1024+(c.charCodeAt(1)-56320);return fromCharCode(240|cc>>>18&7)+fromCharCode(128|cc>>>12&63)+fromCharCode(128|cc>>>6&63)+fromCharCode(128|cc&63)}};var re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g;var utob=function(u){return u.replace(re_utob,cb_utob)};var cb_encode=function(ccc){var padlen=[0,2,1][ccc.length%3],ord=ccc.charCodeAt(0)<<16|(ccc.length>1?ccc.charCodeAt(1):0)<<8|(ccc.length>2?ccc.charCodeAt(2):0),chars=[b64chars.charAt(ord>>>18),b64chars.charAt(ord>>>12&63),padlen>=2?"=":b64chars.charAt(ord>>>6&63),padlen>=1?"=":b64chars.charAt(ord&63)];return chars.join("")};var btoa=global.btoa||function(b){return b.replace(/[\s\S]{1,3}/g,cb_encode)};var _encode=buffer?function(u){return new buffer(u).toString("base64")}:function(u){return btoa(utob(u))};var encode=function(u,urisafe){return!urisafe?_encode(u):_encode(u).replace(/[+\/]/g,function(m0){return m0=="+"?"-":"_"}).replace(/=/g,"")};var encodeURI=function(u){return encode(u,true)};var re_btou=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g");var cb_btou=function(cccc){switch(cccc.length){case 4:var cp=(7&cccc.charCodeAt(0))<<18|(63&cccc.charCodeAt(1))<<12|(63&cccc.charCodeAt(2))<<6|63&cccc.charCodeAt(3),offset=cp-65536;return fromCharCode((offset>>>10)+55296)+fromCharCode((offset&1023)+56320);case 3:return fromCharCode((15&cccc.charCodeAt(0))<<12|(63&cccc.charCodeAt(1))<<6|63&cccc.charCodeAt(2));default:return fromCharCode((31&cccc.charCodeAt(0))<<6|63&cccc.charCodeAt(1))}};var btou=function(b){return b.replace(re_btou,cb_btou)};var cb_decode=function(cccc){var len=cccc.length,padlen=len%4,n=(len>0?b64tab[cccc.charAt(0)]<<18:0)|(len>1?b64tab[cccc.charAt(1)]<<12:0)|(len>2?b64tab[cccc.charAt(2)]<<6:0)|(len>3?b64tab[cccc.charAt(3)]:0),chars=[fromCharCode(n>>>16),fromCharCode(n>>>8&255),fromCharCode(n&255)];chars.length-=[0,0,2,1][padlen];return chars.join("")};var atob=global.atob||function(a){return a.replace(/[\s\S]{1,4}/g,cb_decode)};var _decode=buffer?function(a){return new buffer(a,"base64").toString()}:function(a){return btou(atob(a))};var decode=function(a){return _decode(a.replace(/[-_]/g,function(m0){return m0=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode};if(typeof Object.defineProperty==="function"){var noEnum=function(v){return{value:v,enumerable:false,writable:true,configurable:true}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum(function(){return decode(this)}));Object.defineProperty(String.prototype,"toBase64",noEnum(function(urisafe){return encode(this,urisafe)}));Object.defineProperty(String.prototype,"toBase64URI",noEnum(function(){return encode(this,true)}))}}})(this);

// https://github.com/Yaffle/EventSource
(function(x){function H(){this.data={}}function R(){this.listeners=new H}function S(b){setTimeout(function(){throw b;},0)}function I(b){this.type=b}function T(b,a){this.type=b;this.data=a.data;this.lastEventId=a.lastEventId}function y(b,a){var c=Number(b)||a;return c<J?J:18E6<c?18E6:c}function K(b,a,c){try{"function"===typeof a&&a.call(b,c)}catch(d){S(d)}}function k(b,a){function c(b){var a=h===z||h===t?f.responseText||"":"",c=null;if(h===t&&(c=L?""!==a?f.getResponseHeader("Content-Type"):"":f.contentType,
200===(L?""!==a?f.status:0:200)&&(c&&Z.test(c))&&(h=z,B=!0,u=p,l.readyState=z,c=new I("open"),l.dispatchEvent(c),K(l,l.onopen,c),h===C)))return;if(h===z){a.length>D&&(0!==e&&clearTimeout(e),e=setTimeout(r,J),B=!0);for(var d=D-1,n=a.length;++d<n;){var s=a[d];if(g===M&&"\n"===s)g=v;else if(g===M&&(g=v),"\r"===s||"\n"===s){"data"===q?E.push(m):"id"===q?G=m:"event"===q?w=m:"retry"===q?(u=p=y(m,p),A<p&&(A=p)):"retryLimit"===q?A=y(m,A):"heartbeatTimeout"===q&&(F=y(m,F),0!==e&&(clearTimeout(e),e=setTimeout(r,
F)));q=m="";if(g===v){if(0!==E.length&&(k=G,""===w&&(w="message"),c=new T(w,{data:E.join("\n"),lastEventId:G}),l.dispatchEvent(c),"message"===w&&K(l,l.onmessage,c),h===C))return;E.length=0;w=""}g="\r"===s?M:v}else g===v&&(g=U),g===U?":"===s?g=V:q+=s:g===V?(" "!==s&&(m+=s),g=W):g===W&&(m+=s)}D=n}h!==z&&h!==t||!(b||1048576<D||0===e&&!B)?0===e&&(B=!1,e=setTimeout(r,F)):(h=N,f.abort(),0!==e&&(clearTimeout(e),e=0),u>A&&(u=A),e=setTimeout(r,u),u=2*u+1,l.readyState=t,c=new I("error"),l.dispatchEvent(c),
K(l,l.onerror,c))}function d(){c(!1)}function X(){c(!0)}b=String(b);var n=Boolean(O&&a&&a.withCredentials),p=y(a?a.retry:NaN,1E3),A=y(a?a.retryLimit:NaN,3E5),F=y(a?a.heartbeatTimeout:NaN,45E3),k=a&&a.lastEventId&&String(a.lastEventId)||"",l=this,u=p,B=!1,f=new Y,e=0,D=0,h=N,E=[],G="",w="",r=null,g=v,q="",m="";a=null;r=function(){e=0;if(h!==N)c(!1);else if(!1===navigator.onLine)e=setTimeout(r,500);else if($&&x.document&&("loading"===x.document.readyState||"interactive"===x.document.readyState))e=setTimeout(r,
100);else{f.onload=f.onerror=X;f.onabort=X;void 0===f.mozAnon?f.onprogress=d:f.onreadystatechange=d;B=!1;e=setTimeout(r,F);D=0;h=t;E.length=0;w="";G=k;q=m="";g=v;var a=b.slice(0,5),a="data:"!==a&&"blob:"!==a?b+((-1===b.indexOf("?",0)?"?":"&")+"lastEventId="+encodeURIComponent(k)+"&r="+String(Math.random()+1).slice(2)):b;f.open("GET",a,!0);f.withCredentials=n;f.responseType="text";L&&f.setRequestHeader("Accept","text/event-stream");f.send(null)}};this.listeners=new H;this.close=function(){h=C;null!==
f&&(f.abort(),f=null);0!==e&&(clearTimeout(e),e=0);l.readyState=C};this.url=b;this.readyState=t;this.withCredentials=n;this.onerror=this.onmessage=this.onopen=null;r()}function P(){this.CONNECTING=t;this.OPEN=z;this.CLOSED=C}H.prototype={get:function(b){return this.data[b+"~"]},set:function(b,a){this.data[b+"~"]=a},"delete":function(b){delete this.data[b+"~"]}};R.prototype={dispatchEvent:function(b){var a=this.listeners.get(String(b.type));if(a)for(var c=a.length,d=-1,k=null;++d<c;){k=a[d];try{k.call(this,
b)}catch(n){S(n)}}},addEventListener:function(b,a){b=String(b);var c=this.listeners,d=c.get(b);d||(d=[],c.set(b,d));for(c=d.length;0<=--c;)if(d[c]===a)return;d.push(a)},removeEventListener:function(b,a){b=String(b);var c=this.listeners,d=c.get(b);if(d){for(var k=d.length,n=[],p=-1;++p<k;)d[p]!==a&&n.push(d[p]);if(0===n.length)c["delete"](b);else c.set(b,n)}}};T.prototype=I.prototype;var Q=x.XMLHttpRequest,aa=x.XDomainRequest,O=Boolean(Q&&void 0!==(new Q).withCredentials),L=O,Y=O?Q:aa,N=-1,t=0,z=1,
C=2,M=3,v=4,U=5,V=6,W=7,Z=/^text\/event\-stream;?(\s*charset\=utf\-8)?$/i,$=/AppleWebKit\/5([0-2][0-9]|3[0-4])[\.\s\w]/.test(navigator.userAgent),J=80;P.prototype=R.prototype;k.prototype=new P;P.call(k);Y&&(x.EventSource=k)})(this);
